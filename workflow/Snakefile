import os

__author__ = "Kristina Sungeun Song"
__email__ = "kristina.song@usherbrooke.ca"

configfile: "config/config.yaml"

#############################
## Samples Information
#############################

reads = ["R1","R2"]


#############################
## Load rules
#############################

include: "rules/trim.smk"
include: "rules/fastqc.smk"
include: "rules/align.smk"
include: "rules/quantification.smk"


#############################
## Target rules
#############################

rule all:
    input:
        trim = {
            expand("results/trimmomatic/{sample}_{R}.fastq.gz", R = reads),
            expand("results/trimmomatic/{sample}_{R}.unpaired.fastq.gz", R = reads)
        },
        fastqc = {
            expand("results/fastqc_pretrim/{sample}_{R}.html", R = reads),
            expand("results/fastqc_pretrim/{sample}_{R}_fastqc.zip", R = reads),
            expand("results/fastqc_posttrim/{sample}_{R}.html", R = reads),
            expand("results/fastqc_posttrim/{sample}_{R}_fastqc.zip", R = reads)
        },
        star = {
            directory(config["path"]["star_index"]),
            "results/star/{sample}/Aligned.sortedByCoord.out.bam",
            "results/star/{sample}/Log.out"
        },
        bedgraphs = {
            "results/genomecov/{sample}.bedgraph"  
        },
        kallisto = {
            config["path"]["transcriptome"],
            config["path"]["kallisto_index"],
            directory("results/kallisto_quant/{sample}")
        }